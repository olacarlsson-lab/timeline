<!DOCTYPE html>
<html lang="sv">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KPL-projekt</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="icon.ico" type="image/x-icon">
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
    <link rel="apple-touch-icon" href="icon-192.png">
    <meta name="theme-color" content="#31567D">
</head>

<body>
    <div class="app">
        <header class="header">
            <div class="controls">
                <button id="controlPanelToggle" title="Filter & inställningar">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="4" y1="21" x2="4" y2="14"></line><line x1="4" y1="10" x2="4" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="3"></line>
                        <line x1="20" y1="21" x2="20" y2="16"></line><line x1="20" y1="12" x2="20" y2="3"></line>
                        <line x1="1" y1="14" x2="7" y2="14"></line><line x1="9" y1="8" x2="15" y2="8"></line>
                        <line x1="17" y1="16" x2="23" y2="16"></line>
                    </svg>
                    <span id="filterIndicator" class="filter-indicator" style="display:none;"></span>
                </button>
                <button id="addProjectBtn" class="btn btn-primary">+ Projekt</button>
                <button id="addEventBtn" class="btn btn-secondary">+ Händelse</button>
                <div class="divider"></div>
                <div class="view-controls">
                    <button id="viewAll" class="btn btn-view" title="Visa alla kvartal">Totalt</button>
                    <button id="view2Years" class="btn btn-view" title="Två år från idag">2 år</button>
                    <button id="view1Year" class="btn btn-view" title="Ett år framåt">1 år</button>
                    <button id="view3Months" class="btn btn-view active" title="Kommande tre månader">3 mån</button>
                </div>
                <button id="todayBtn" class="btn btn-secondary">Idag</button>
            </div>
        </header>

        <div id="controlPanelBackdrop" class="control-panel-backdrop"></div>
        <div id="controlPanel" class="control-panel">
            <div class="control-panel-header">
                <h3>Filter & inställningar</h3>
                <button id="controlPanelClose" class="btn-icon">&#10005;</button>
            </div>
            <div class="control-panel-body">
                <div class="panel-section">
                    <label for="searchInput">Sök</label>
                    <input type="search" id="searchInput" placeholder="Sök projekt..." class="search-input">
                </div>
                <div class="panel-section">
                    <label for="filterLead">Projektledare</label>
                    <select id="filterLead">
                        <option value="">Alla</option>
                    </select>
                </div>
                <div class="panel-section">
                    <label for="filterStatus">Status</label>
                    <select id="filterStatus">
                        <option value="">Alla</option>
                        <option value="early">Tidig fas</option>
                        <option value="procurement">Upphandling</option>
                        <option value="implementation">Genomförande</option>
                        <option value="completion">Avslut</option>
                    </select>
                </div>
                <div class="panel-section">
                    <label for="filterArea">Område</label>
                    <select id="filterArea">
                        <option value="">Alla</option>
                    </select>
                </div>
                <div class="panel-divider"></div>
                <div class="panel-section">
                    <label for="sortSelect">Sortera</label>
                    <select id="sortSelect">
                        <option value="lead">Projektledare</option>
                        <option value="color">Område</option>
                        <option value="name">Namn</option>
                        <option value="start">Startdatum</option>
                        <option value="end">Slutdatum</option>
                        <option value="status">Status</option>
                    </select>
                </div>
                <div class="panel-divider"></div>
                <div class="panel-section">
                    <label>Tidslinje</label>
                    <div class="panel-range">
                        <input type="number" id="timelineStartYear" class="year-input" min="2000" max="2100" title="Startår">
                        <span class="range-separator">–</span>
                        <input type="number" id="timelineEndYear" class="year-input" min="2000" max="2100" title="Slutår">
                    </div>
                </div>
                <div class="panel-divider"></div>
                <div class="panel-section panel-section-row">
                    <button id="exportBtn" class="btn btn-secondary">Spara</button>
                    <button id="importBtn" class="btn btn-secondary">Öppna</button>
                    <input type="file" id="importFile" accept=".json" style="display: none;">
                </div>
                <div class="panel-divider"></div>
                <div class="panel-section">
                    <label>Områden</label>
                    <div id="areaList" class="area-list"></div>
                    <div id="areaAddForm" class="area-add-form">
                        <input type="color" id="areaNewColor" value="#6366f1" class="area-color-input">
                        <input type="text" id="areaNewName" placeholder="Nytt område..." class="area-name-input">
                        <button id="areaAddBtn" class="btn btn-primary area-add-btn">+</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="timeline-container" id="timelineContainer">
            <div class="timeline-header" id="timelineHeader"></div>
            <div class="timeline-body" id="timelineBody">
                <div class="timeline-grid" id="timelineGrid"></div>
                <div class="timeline-content" id="timelineContent"></div>
                <div class="today-marker" id="todayMarker"></div>
            </div>
        </div>
    </div>

    <!-- Modal för att lägga till projekt -->
    <div class="modal" id="projectModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Nytt projekt</h2>
                <button class="modal-close" id="closeProjectModal">&times;</button>
            </div>
            <form id="projectForm">
                <div class="form-group">
                    <label for="projectName">Projektnamn</label>
                    <input type="text" id="projectName" required>
                </div>
                <div class="form-group">
                    <label for="projectLead">Projektledare</label>
                    <input type="text" id="projectLead" placeholder="Valfritt">
                </div>
                <div class="form-group">
                    <label for="projectStatus">Status</label>
                    <select id="projectStatus">
                        <option value="early">Tidigt skede</option>
                        <option value="procurement">Upphandling</option>
                        <option value="implementation" selected>Genomförande</option>
                        <option value="completion">Slutförande</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Startdatum</label>
                    <div class="date-picker">
                        <select id="projectStartType" class="date-type-select">
                            <option value="date">Datum</option>
                            <option value="week">Vecka</option>
                            <option value="month">Månad</option>
                        </select>
                        <input type="date" id="projectStartDate" class="date-input">
                        <div id="projectStartWeekGroup" class="week-group" style="display:none;">
                            <select id="projectStartWeekNum" class="week-num-input"></select>
                            <select id="projectStartWeekYear" class="week-year-input"></select>
                        </div>
                        <div id="projectStartMonthGroup" class="month-group" style="display:none;">
                            <select id="projectStartMonthNum" class="month-num-input"></select>
                            <select id="projectStartMonthYear" class="month-year-input"></select>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Slutdatum</label>
                    <div class="date-picker">
                        <select id="projectEndType" class="date-type-select">
                            <option value="date">Datum</option>
                            <option value="week">Vecka</option>
                            <option value="month">Månad</option>
                        </select>
                        <input type="date" id="projectEndDate" class="date-input">
                        <div id="projectEndWeekGroup" class="week-group" style="display:none;">
                            <select id="projectEndWeekNum" class="week-num-input"></select>
                            <select id="projectEndWeekYear" class="week-year-input"></select>
                        </div>
                        <div id="projectEndMonthGroup" class="month-group" style="display:none;">
                            <select id="projectEndMonthNum" class="month-num-input"></select>
                            <select id="projectEndMonthYear" class="month-year-input"></select>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="projectColor">Område</label>
                    <select id="projectColor" class="color-select">
                    </select>
                    <a href="#" id="openAreasFromProject" class="form-hint-link">Hantera områden</a>
                </div>
                <div class="form-group">
                    <label for="projectComment">Kommentar</label>
                    <textarea id="projectComment" rows="3" placeholder="Valfri kommentar..."></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelProject">Avbryt</button>
                    <button type="submit" class="btn btn-primary">Spara</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal för att lägga till händelse -->
    <div class="modal" id="eventModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Ny händelse</h2>
                <button class="modal-close" id="closeEventModal">&times;</button>
            </div>
            <form id="eventForm">
                <div class="form-group">
                    <label for="eventName">Händelse</label>
                    <input type="text" id="eventName" required>
                </div>
                <div class="form-group">
                    <label>Startdatum</label>
                    <div class="date-picker">
                        <select id="eventStartType" class="date-type-select">
                            <option value="date">Datum</option>
                            <option value="week">Vecka</option>
                            <option value="month">Månad</option>
                        </select>
                        <input type="date" id="eventStartDate" class="date-input">
                        <div id="eventStartWeekGroup" class="week-group" style="display:none;">
                            <select id="eventStartWeekNum" class="week-num-input"></select>
                            <select id="eventStartWeekYear" class="week-year-input"></select>
                        </div>
                        <div id="eventStartMonthGroup" class="month-group" style="display:none;">
                            <select id="eventStartMonthNum" class="month-num-input"></select>
                            <select id="eventStartMonthYear" class="month-year-input"></select>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Slutdatum (valfritt)</label>
                    <div class="date-picker">
                        <select id="eventEndType" class="date-type-select">
                            <option value="date">Datum</option>
                            <option value="week">Vecka</option>
                            <option value="month">Månad</option>
                        </select>
                        <input type="date" id="eventEndDate" class="date-input">
                        <div id="eventEndWeekGroup" class="week-group" style="display:none;">
                            <select id="eventEndWeekNum" class="week-num-input"></select>
                            <select id="eventEndWeekYear" class="week-year-input"></select>
                        </div>
                        <div id="eventEndMonthGroup" class="month-group" style="display:none;">
                            <select id="eventEndMonthNum" class="month-num-input"></select>
                            <select id="eventEndMonthYear" class="month-year-input"></select>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="eventProject">Projekt (valfritt)</label>
                    <select id="eventProject">
                        <option value="">Ingen koppling</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="eventSymbol">Symbol (valfritt)</label>
                    <select id="eventSymbol">
                        <option value="">Standard (Balk/Punkt)</option>
                        <option value="star">Stjärna</option>
                        <option value="diamond">Diamant</option>
                        <option value="flag">Flagga</option>
                        <option value="warning">Varning</option>
                        <option value="check">Klar</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="eventComment">Kommentar</label>
                    <textarea id="eventComment" rows="3" placeholder="Valfri kommentar..."></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelEvent">Avbryt</button>
                    <button type="submit" class="btn btn-primary">Spara</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal för att redigera/ta bort -->
    <div class="modal" id="editModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="editModalTitle">Redigera</h2>
                <button class="modal-close" id="closeEditModal">&times;</button>
            </div>
            <form id="editForm">
                <div class="form-group">
                    <label for="editName">Namn</label>
                    <input type="text" id="editName" required>
                </div>
                <div class="form-group" id="editLeadGroup">
                    <label for="editLead">Projektledare</label>
                    <input type="text" id="editLead" placeholder="Valfritt">
                </div>
                <div class="form-group" id="editStatusGroup">
                    <label for="editStatus">Status</label>
                    <select id="editStatus">
                        <option value="early">Tidigt skede</option>
                        <option value="procurement">Upphandling</option>
                        <option value="implementation">Genomförande</option>
                        <option value="completion">Slutförande</option>
                    </select>
                </div>
                <div class="form-group" id="editStartGroup">
                    <label>Startdatum</label>
                    <div class="date-picker">
                        <select id="editStartType" class="date-type-select">
                            <option value="date">Datum</option>
                            <option value="week">Vecka</option>
                            <option value="month">Månad</option>
                        </select>
                        <input type="date" id="editStartDate" class="date-input">
                        <div id="editStartWeekGroup" class="week-group" style="display:none;">
                            <select id="editStartWeekNum" class="week-num-input"></select>
                            <select id="editStartWeekYear" class="week-year-input"></select>
                        </div>
                        <div id="editStartMonthGroup" class="month-group" style="display:none;">
                            <select id="editStartMonthNum" class="month-num-input"></select>
                            <select id="editStartMonthYear" class="month-year-input"></select>
                        </div>
                    </div>
                </div>
                <div class="form-group" id="editEndGroup">
                    <label>Slutdatum</label>
                    <div class="date-picker">
                        <select id="editEndType" class="date-type-select">
                            <option value="date">Datum</option>
                            <option value="week">Vecka</option>
                            <option value="month">Månad</option>
                        </select>
                        <input type="date" id="editEndDate" class="date-input">
                        <div id="editEndWeekGroup" class="week-group" style="display:none;">
                            <select id="editEndWeekNum" class="week-num-input"></select>
                            <select id="editEndWeekYear" class="week-year-input"></select>
                        </div>
                        <div id="editEndMonthGroup" class="month-group" style="display:none;">
                            <select id="editEndMonthNum" class="month-num-input"></select>
                            <select id="editEndMonthYear" class="month-year-input"></select>
                        </div>
                    </div>
                </div>
                <div class="form-group" id="editEventStartGroup">
                    <label>Startdatum</label>
                    <div class="date-picker">
                        <select id="editEventStartType" class="date-type-select">
                            <option value="date">Datum</option>
                            <option value="week">Vecka</option>
                            <option value="month">Månad</option>
                        </select>
                        <input type="date" id="editEventStartDate" class="date-input">
                        <div id="editEventStartWeekGroup" class="week-group" style="display:none;">
                            <select id="editEventStartWeekNum" class="week-num-input"></select>
                            <select id="editEventStartWeekYear" class="week-year-input"></select>
                        </div>
                        <div id="editEventStartMonthGroup" class="month-group" style="display:none;">
                            <select id="editEventStartMonthNum" class="month-num-input"></select>
                            <select id="editEventStartMonthYear" class="month-year-input"></select>
                        </div>
                    </div>
                </div>
                <div class="form-group" id="editEventEndGroup">
                    <label>Slutdatum (valfritt)</label>
                    <div class="date-picker">
                        <select id="editEventEndType" class="date-type-select">
                            <option value="date">Datum</option>
                            <option value="week">Vecka</option>
                            <option value="month">Månad</option>
                        </select>
                        <input type="date" id="editEventEndDate" class="date-input">
                        <div id="editEventEndWeekGroup" class="week-group" style="display:none;">
                            <select id="editEventEndWeekNum" class="week-num-input"></select>
                            <select id="editEventEndWeekYear" class="week-year-input"></select>
                        </div>
                        <div id="editEventEndMonthGroup" class="month-group" style="display:none;">
                            <select id="editEventEndMonthNum" class="month-num-input"></select>
                            <select id="editEventEndMonthYear" class="month-year-input"></select>
                        </div>
                    </div>
                </div>
                <div class="form-group" id="editProjectGroup">
                    <label for="editProject">Projekt</label>
                    <select id="editProject">
                        <option value="">Ingen koppling</option>
                    </select>
                </div>
                <div class="form-group" id="editSymbolGroup">
                    <label for="editSymbol">Symbol (valfritt)</label>
                    <select id="editSymbol">
                        <option value="">Standard (Balk/Punkt)</option>
                        <option value="star">Stjärna</option>
                        <option value="diamond">Diamant</option>
                        <option value="flag">Flagga</option>
                        <option value="warning">Varning</option>
                        <option value="check">Klar</option>
                    </select>
                </div>
                <div class="form-group" id="editColorGroup">
                    <label for="editColor">Område</label>
                    <select id="editColor" class="color-select">
                    </select>
                    <a href="#" id="openAreasFromEdit" class="form-hint-link">Hantera områden</a>
                </div>
                <div class="form-group" id="editCommentGroup">
                    <label for="editComment">Kommentar</label>
                    <textarea id="editComment" rows="3" placeholder="Valfri kommentar..."></textarea>
                </div>
                <input type="hidden" id="editId">
                <input type="hidden" id="editType">
                <div class="form-actions">
                    <button type="button" class="btn btn-danger" id="deleteItem">Ta bort</button>
                    <button type="button" class="btn btn-secondary" id="cancelEdit">Avbryt</button>
                    <button type="submit" class="btn btn-primary">Spara</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Project Sidebar -->
    <div id="projectSidebar" class="sidebar sidebar-left">
        <div class="sidebar-header">
            <h2 id="sidebarTitle">Projektdetaljer</h2>
            <button id="closeSidebar" class="btn-icon">&#10005;</button>
        </div>
        <div class="sidebar-content" id="sidebarContent">
        </div>
        <div class="sidebar-actions">
            <button id="sidebarEditBtn" class="btn btn-primary">Redigera</button>
        </div>
    </div>

    <!-- Event Sidebar -->
    <div id="eventSidebar" class="sidebar sidebar-right">
        <div class="sidebar-header">
            <h2 id="eventSidebarTitle">Händelsedetaljer</h2>
            <button id="closeEventSidebar" class="btn-icon">&#10005;</button>
        </div>
        <div class="sidebar-content" id="eventSidebarContent">
        </div>
        <div class="sidebar-actions">
            <button id="eventSidebarEditBtn" class="btn btn-primary">Redigera</button>
        </div>
    </div>

    <script src="app.js"></script>
</body>

</html>
